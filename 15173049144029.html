<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  密码学安全随机数 - 记录
  
  </title>
 <meta name="description" content="记录工作上的知识点">
 <link href="atom.xml" rel="alternate" title="记录" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />

    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
    <script src="asset/highlightjs/highlight.pack.js"></script>
    <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>hljs.initHighlightingOnLoad();</script>
    
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>

<div id="header">
    <h1><a href="index.html">记录</a></h1>
</div>

</nav>
        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; 记录</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
      <li><a href="index.html">Home</a></li>
      
        <li class="divider"></li>
        <li><label>C++</label></li>

          
            <li><a title="gcc第三方库文件目录" href="15173624959342.html">gcc第三方库文件目录</a></li>
          
            <li><a title="字符编码" href="15173053129472.html">字符编码</a></li>
          
            <li><a title="跨平台C／C++系统／编译器检测" href="15173052079033.html">跨平台C／C++系统／编译器检测</a></li>
          
            <li><a title="curl库编译" href="15173051110022.html">curl库编译</a></li>
          
            <li><a title="GCC编译动态库" href="15173051110801.html">GCC编译动态库</a></li>
          
            <li><a title="GCC编译静态库" href="15173051111098.html">GCC编译静态库</a></li>
          
            <li><a title="openssl编译" href="15173051111412.html">openssl编译</a></li>
          
            <li><a title="全局变量" href="15173051111702.html">全局变量</a></li>
          
            <li><a title="编译器预定义宏" href="15173044802818.html">编译器预定义宏</a></li>
          
            <li><a title="Makefile" href="15173044568587.html">Makefile</a></li>
          
            <li><a title="命令行参数解析" href="15173044214676.html">命令行参数解析</a></li>
          
            <li><a title="C++多线程" href="15173028055344.html">C++多线程</a></li>
          
            <li><a title="C++ 输入输出流" href="15172827779506.html">C++ 输入输出流</a></li>
          

      
        <li class="divider"></li>
        <li><label>Xcode</label></li>

          
            <li><a title="XCode" href="15173027753385.html">XCode</a></li>
          
            <li><a title="Git" href="15173027520921.html">Git</a></li>
          
            <li><a title="lldb" href="15172828404139.html">lldb</a></li>
          

      
        <li class="divider"></li>
        <li><label>Linux</label></li>

          
            <li><a title="Shell 脚本" href="15173027148008.html">Shell 脚本</a></li>
          
            <li><a title="Linux基本指令" href="15173026872373.html">Linux基本指令</a></li>
          
            <li><a title="cenos 安装 gcc/clang" href="15173026443060.html">cenos 安装 gcc/clang</a></li>
          

      
        <li class="divider"></li>
        <li><label>Crypt</label></li>

          
            <li><a title="Intel random number generator" href="15173049140113.html">Intel random number generator</a></li>
          
            <li><a title="Linux /dev/random" href="15173049140539.html">Linux /dev/random</a></li>
          
            <li><a title="Linux同步IO" href="15173049140754.html">Linux同步IO</a></li>
          
            <li><a title="Linux页缓存" href="15173049141059.html">Linux页缓存</a></li>
          
            <li><a title="OpenSSH" href="15173049141355.html">OpenSSH</a></li>
          
            <li><a title="RSA简介" href="15173049141721.html">RSA简介</a></li>
          
            <li><a title="Slat" href="15173049142023.html">Slat</a></li>
          
            <li><a title="SHA" href="15173049142331.html">SHA</a></li>
          
            <li><a title="SM9加密" href="15173049142669.html">SM9加密</a></li>
          
            <li><a title="SM9数字签名" href="15173049142971.html">SM9数字签名</a></li>
          
            <li><a title="SM9特点" href="15173049143327.html">SM9特点</a></li>
          
            <li><a title="SM9代码注释" href="15173049143691.html">SM9代码注释</a></li>
          
            <li><a title="Ciphertext stealing" href="15173049143733.html">Ciphertext stealing</a></li>
          
            <li><a title="分组加密的加密模式" href="15173049143929.html">分组加密的加密模式</a></li>
          
            <li><a title="加密key生成" href="15173049143979.html">加密key生成</a></li>
          
            <li><a title="密码学安全随机数" href="15173049144029.html">密码学安全随机数</a></li>
          
            <li><a title="数据加密方式比较" href="15173049144073.html">数据加密方式比较</a></li>
          
            <li><a title="文件加密解密流程" href="15173049144311.html">文件加密解密流程</a></li>
          
            <li><a title="椭圆曲线密码学" href="15173049144364.html">椭圆曲线密码学</a></li>
          
            <li><a title="消息认证码" href="15173049144611.html">消息认证码</a></li>
          
            <li><a title="认证加密" href="15173049144928.html">认证加密</a></li>
          
            <li><a title="随机数检测规范" href="15173049145208.html">随机数检测规范</a></li>
          
            <li><a title="AES" href="15173049138687.html">AES</a></li>
          
            <li><a title="AES测试实例" href="15173049139197.html">AES测试实例</a></li>
          
            <li><a title="ECC性能" href="15173049139393.html">ECC性能</a></li>
          
            <li><a title="基于标识的加密" href="15173049139748.html">基于标识的加密</a></li>
          

      
        <li class="divider"></li>
        <li><label>Computer</label></li>

          
            <li><a title="磁盘传输" href="15173050634716.html">磁盘传输</a></li>
          

      
        <li class="divider"></li>
        <li><label>genome</label></li>

          
            <li><a title="Illumina Sequencing" href="15173054141309.html">Illumina Sequencing</a></li>
          
            <li><a title="Illumina二代测序原理" href="15173054141798.html">Illumina二代测序原理</a></li>
          
            <li><a title="DNA基本关系" href="15173054025402.html">DNA基本关系</a></li>
          

      
      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>

        <section id="main-content" role="main" class="scroll-container">

          <div class="row">
            <div class="large-3 medium-3 columns">
              <div class="hide-for-small">
                <div class="sidebar">
                <nav>
                  <ul id="side-nav" class="side-nav">

                    
                      <li class="side-title"><span>C++</span></li>
                        
                          <li><a title="gcc第三方库文件目录" href="15173624959342.html">gcc第三方库文件目录</a></li>
                        
                          <li><a title="字符编码" href="15173053129472.html">字符编码</a></li>
                        
                          <li><a title="跨平台C／C++系统／编译器检测" href="15173052079033.html">跨平台C／C++系统／编译器检测</a></li>
                        
                          <li><a title="curl库编译" href="15173051110022.html">curl库编译</a></li>
                        
                          <li><a title="GCC编译动态库" href="15173051110801.html">GCC编译动态库</a></li>
                        
                          <li><a title="GCC编译静态库" href="15173051111098.html">GCC编译静态库</a></li>
                        
                          <li><a title="openssl编译" href="15173051111412.html">openssl编译</a></li>
                        
                          <li><a title="全局变量" href="15173051111702.html">全局变量</a></li>
                        
                          <li><a title="编译器预定义宏" href="15173044802818.html">编译器预定义宏</a></li>
                        
                          <li><a title="Makefile" href="15173044568587.html">Makefile</a></li>
                        
                          <li><a title="命令行参数解析" href="15173044214676.html">命令行参数解析</a></li>
                        
                          <li><a title="C++多线程" href="15173028055344.html">C++多线程</a></li>
                        
                          <li><a title="C++ 输入输出流" href="15172827779506.html">C++ 输入输出流</a></li>
                        

                    
                      <li class="side-title"><span>Xcode</span></li>
                        
                          <li><a title="XCode" href="15173027753385.html">XCode</a></li>
                        
                          <li><a title="Git" href="15173027520921.html">Git</a></li>
                        
                          <li><a title="lldb" href="15172828404139.html">lldb</a></li>
                        

                    
                      <li class="side-title"><span>Linux</span></li>
                        
                          <li><a title="Shell 脚本" href="15173027148008.html">Shell 脚本</a></li>
                        
                          <li><a title="Linux基本指令" href="15173026872373.html">Linux基本指令</a></li>
                        
                          <li><a title="cenos 安装 gcc/clang" href="15173026443060.html">cenos 安装 gcc/clang</a></li>
                        

                    
                      <li class="side-title"><span>Crypt</span></li>
                        
                          <li><a title="Intel random number generator" href="15173049140113.html">Intel random number generator</a></li>
                        
                          <li><a title="Linux /dev/random" href="15173049140539.html">Linux /dev/random</a></li>
                        
                          <li><a title="Linux同步IO" href="15173049140754.html">Linux同步IO</a></li>
                        
                          <li><a title="Linux页缓存" href="15173049141059.html">Linux页缓存</a></li>
                        
                          <li><a title="OpenSSH" href="15173049141355.html">OpenSSH</a></li>
                        
                          <li><a title="RSA简介" href="15173049141721.html">RSA简介</a></li>
                        
                          <li><a title="Slat" href="15173049142023.html">Slat</a></li>
                        
                          <li><a title="SHA" href="15173049142331.html">SHA</a></li>
                        
                          <li><a title="SM9加密" href="15173049142669.html">SM9加密</a></li>
                        
                          <li><a title="SM9数字签名" href="15173049142971.html">SM9数字签名</a></li>
                        
                          <li><a title="SM9特点" href="15173049143327.html">SM9特点</a></li>
                        
                          <li><a title="SM9代码注释" href="15173049143691.html">SM9代码注释</a></li>
                        
                          <li><a title="Ciphertext stealing" href="15173049143733.html">Ciphertext stealing</a></li>
                        
                          <li><a title="分组加密的加密模式" href="15173049143929.html">分组加密的加密模式</a></li>
                        
                          <li><a title="加密key生成" href="15173049143979.html">加密key生成</a></li>
                        
                          <li><a title="密码学安全随机数" href="15173049144029.html">密码学安全随机数</a></li>
                        
                          <li><a title="数据加密方式比较" href="15173049144073.html">数据加密方式比较</a></li>
                        
                          <li><a title="文件加密解密流程" href="15173049144311.html">文件加密解密流程</a></li>
                        
                          <li><a title="椭圆曲线密码学" href="15173049144364.html">椭圆曲线密码学</a></li>
                        
                          <li><a title="消息认证码" href="15173049144611.html">消息认证码</a></li>
                        
                          <li><a title="认证加密" href="15173049144928.html">认证加密</a></li>
                        
                          <li><a title="随机数检测规范" href="15173049145208.html">随机数检测规范</a></li>
                        
                          <li><a title="AES" href="15173049138687.html">AES</a></li>
                        
                          <li><a title="AES测试实例" href="15173049139197.html">AES测试实例</a></li>
                        
                          <li><a title="ECC性能" href="15173049139393.html">ECC性能</a></li>
                        
                          <li><a title="基于标识的加密" href="15173049139748.html">基于标识的加密</a></li>
                        

                    
                      <li class="side-title"><span>Computer</span></li>
                        
                          <li><a title="磁盘传输" href="15173050634716.html">磁盘传输</a></li>
                        

                    
                      <li class="side-title"><span>genome</span></li>
                        
                          <li><a title="Illumina Sequencing" href="15173054141309.html">Illumina Sequencing</a></li>
                        
                          <li><a title="Illumina二代测序原理" href="15173054141798.html">Illumina二代测序原理</a></li>
                        
                          <li><a title="DNA基本关系" href="15173054025402.html">DNA基本关系</a></li>
                        

                    
                  </ul>
                </nav>
                </div>
              </div>
            </div>
            <div class="large-9 medium-9 columns">

 <div class="markdown-body">
<h1>密码学安全随机数</h1>

<blockquote>
<p>A <strong>cryptographically secure pseudo-random number generator</strong> (<strong>CSPRNG</strong>) or <strong>cryptographic pseudo-random number generator</strong>(<strong>CPRNG</strong>)<a href="http://www.wikiwand.com/en/Cryptographically_secure_pseudorandom_number_generator#citenote1">[1]</a> is a <a href="http://www.wikiwand.com/en/Pseudo-random_number_generator">pseudo-random number generator</a> (PRNG) with properties that make it suitable for use in <a href="http://www.wikiwand.com/en/Cryptography">cryptography</a>.</p>

<p>Many aspects of cryptography require <a href="http://www.wikiwand.com/en/Random">random</a> numbers, for example:</p>

<ul>
<li><a href="http://www.wikiwand.com/en/Key_generation">key generation</a></li>
<li><a href="http://www.wikiwand.com/en/Cryptographic_nonce">nonces</a></li>
<li><a href="http://www.wikiwand.com/en/One-time_pad">one-time pads</a></li>
<li><a href="http://www.wikiwand.com/en/Salt_(cryptography)">salts</a> in certain signature schemes, including <a href="http://www.wikiwand.com/en/ECDSA">ECDSA</a>, RSASSA-PSS</li>
</ul>
</blockquote>

<p>密码学随机数必须不可预测下一位（在多项式时间内不能获得好于50%正确率的结果）。</p>

<h2 id="toc_0">生成器设计</h2>

<ol>
<li>基于加密函数或者hash函数</li>
<li>基于数学上的难题</li>
<li>特殊目的的设计</li>
</ol>

<h3 id="toc_1">基于密码学设计</h3>

<ul>
<li>分组加密器在<em>counter mode</em>时可转换为CSPRNG。随机选择一个key加密0.然后加密1.然后加密2，ect。counter也可以随便的选取一个数字作为开始。</li>
<li>hash函数对<em>counter</em>也可以作为一个好的CSPRNG</li>
<li>在流加密器中生成的伪随机序列再异或原文，加密器在<em>counter</em>模式运行可以得到一个新的伪随机序列，可能周期很长。只有原序列就是一个很好的CSPRNG，结果才能是个好的CSPRNG</li>
</ul>

<h3 id="toc_2">基于数论的设计</h3>

<ul>
<li><strong>Blum Blum Shub(B.B.S)</strong>伪随机数生成器在1986年被提出，\(x_{n+1}=x_{n}^2\bmod{M},where  M = pq\), p,q是两个足够大的素数。这个算法是非常低效的。</li>
<li><strong>Blum-Micali algorithm</strong>也是非常低效的</li>
</ul>

<h3 id="toc_3">特殊设计</h3>

<ul>
<li>Yarrow algorithm估算系统输入熵的量。在FreeBSD和Mac OS X中使用</li>
<li>ChaCha20 algorithm算法在OpenBSD和NetBSD和Linux中使用</li>
<li>Fortuna algorithm是Yarrow算法的后继者，它不试图衡量输入的熵</li>
<li>CryptGenRandom是Microsoft的随机数生成接口(推荐使用rand_s函数，是CryptGenRandom的封装)</li>
</ul>

<h2 id="toc_4">Yarrow</h2>

<ul>
<li>Hash function</li>
<li>Block cipher</li>
</ul>

<h3 id="toc_5">Generation</h3>

<p><img src="https://gitee.com/uploads/images/2017/1213/103305_679d78f1_1453931.png" alt="Yarrow" title="Functions_for_Generation_Mechanism.png"/></p>

<p>C是内部维护的<strong>Counter Mode</strong>的nbit值，K是加密key。</p>

<h3 id="toc_6">Reseed</h3>

<p>Yarrow 高效的，</p>

<h2 id="toc_7">Visual Studio random_device</h2>

<p>The class describes a source of random numbers, and is allowed but not required to be <strong>non-deterministic or cryptographically secure</strong> by the ISO C++ Standard.  In the Visual Studio implementation the values produced are non-deterministic and cryptographically secure.</p>

<blockquote>
<p>The RNG generates as specified in FIPS 186-2 appendix 3.1 with SHA-1 as the G function. With entropy from:</p>

<p>The current process ID (GetCurrentProcessID).</p>

<p>The current thread ID (GetCurrentThreadID).</p>

<p>The ticks since boot (GetTickCount).</p>

<p>The current time (GetLocalTime).</p>

<p>Various high-precision performance counters (QueryPerformanceCounter).</p>

<p>An MD4 hash of the user’s environment block, which includes username, computer name, and search path. MD4 is a hashing algorithm that creates a 128-bit message digest from input data to verify data integrity.</p>

<p>High-precision internal CPU counters, such as RDTSC, RDMSR, RDPMC </p>

<p>Low-level system information: Idle Process Time, Io Read Transfer Count, I/O Write Transfer Count, I/O Other Transfer Count, I/O Read Operation Count, I/O Write Operation Count, I/O Other Operation Count, Available Pages, Committed Pages, Commit Limit, Peak Commitment, Page Fault Count, Copy On Write Count, Transition Count, Cache Transition Count, Demand Zero Count, Page Read Count, Page Read I/O Count, Cache Read Count, Cache I/O Count, Dirty Pages Write Count, Dirty Write I/O Count, Mapped Pages Write Count, Mapped Write I/O Count, Paged Pool Pages, Non Paged Pool Pages, Paged Pool Allocated space, Paged Pool Free space, Non Paged Pool Allocated space, Non Paged Pool Free space, Free System page table entry, Resident System Code Page, Total System Driver Pages, Total System Code Pages, Non Paged Pool Lookaside Hits, Paged Pool Lookaside Hits, Available Paged Pool Pages, Resident System Cache Page, Resident Paged Pool Page, Resident System Driver Page, Cache manager Fast Read with No Wait, Cache manager Fast Read with Wait, Cache manager Fast Read Resource Missed, Cache manager Fast Read Not Possible, Cache manager Fast Memory Descriptor List Read with No Wait, Cache manager Fast Memory Descriptor List Read with Wait, Cache manager Fast Memory Descriptor List Read Resource Missed, Cache manager Fast Memory Descriptor List Read Not Possible, Cache manager Map Data with No Wait, Cache manager Map Data with Wait, Cache manager Map Data with No Wait Miss, Cache manager Map Data Wait Miss, Cache manager Pin-Mapped Data Count, Cache manager Pin-Read with No Wait, Cache manager Pin Read with Wait, Cache manager Pin-Read with No Wait Miss, Cache manager Pin-Read Wait Miss, Cache manager Copy-Read with No Wait, Cache manager Copy-Read with Wait, Cache manager Copy-Read with No Wait Miss, Cache manager Copy-Read with Wait Miss, Cache manager Memory Descriptor List Read with No Wait, Cache manager Memory Descriptor List Read with Wait, Cache manager Memory Descriptor List Read with No Wait Miss, Cache manager Memory Descriptor List Read with Wait Miss, Cache manager Read Ahead IOs, Cache manager Lazy-Write IOs, Cache manager Lazy-Write Pages, Cache manager Data Flushes, Cache manager Data Pages, Context Switches, First Level Translation buffer Fills, Second Level Translation buffer Fills, and System Calls.</p>

<p>System exception information consisting of Alignment Fix up Count, Exception Dispatch Count, Floating Emulation Count, and Byte Word Emulation Count.</p>

<p>System lookaside information consisting of Current Depth, Maximum Depth, Total Allocates, Allocate Misses, Total Frees, Free Misses, Type, Tag, and Size.</p>

<p>System interrupt information consisting of context switches, deferred procedure call count, deferred procedure call rate, time increment, deferred procedure call bypass count, and asynchronous procedure call bypass count.</p>

<p>System process information consisting of Next Entry Offset, Number Of Threads, Create Time, User Time, Kernel Time, Image Name, Base Priority, Unique Process ID, Inherited from Unique Process ID, Handle Count, Session ID, Page Directory Base, Peak Virtual Size, Virtual Size, Page Fault Count, Peak Working Set Size, Working Set Size, Quota Peak Paged Pool Usage, Quota Paged Pool Usage, Quota Peak Non Paged Pool Usage, Quota Non Paged Pool Usage, Page file Usage, Peak Page file Usage, Private Page Count, Read Operation Count, Write Operation Count, Other Operation Count, Read Transfer Count, Write Transfer Count, and Other Transfer Count.</p>
</blockquote>


</div>

<br /><br />
<hr />

<div class="row clearfix">
  <div class="large-6 columns">
	<div class="text-left" style="padding:15px 0px;">
		
	        <a href="15173049143979.html"  title="Previous Post: 加密key生成">&laquo; 加密key生成</a>
	    
	</div>
  </div>
  <div class="large-6 columns">
	<div class="text-right" style="padding:15px 0px;">
		
	        <a href="15173049144073.html" 
	        title="Next Post: 数据加密方式比较">数据加密方式比较 &raquo;</a>
	    
	</div>
  </div>
</div>

<div class="row">
<div style="padding:0px 0.93em;" class="share-comments">

</div>
</div>
<script type="text/javascript">
	$(function(){
		var currentURL = '15173049144029.html';
		$('#side-nav a').each(function(){
			if($(this).attr('href') == currentURL){
				$(this).parent().addClass('active');
			}
		});
	});
</script>  
</div></div>


<div class="page-bottom">
  <div class="row">
  <hr />
  <div class="small-9 columns">
  <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
  <div class="small-3 columns">
  <p class="copyright text-right"><a href="#header">TOP</a></p>
  </div>
   
  </div>
</div>

        </section>
      </div>
    </div>
    
    
    <script src="asset/js/foundation.min.js"></script>
    <script src="asset/js/foundation/foundation.offcanvas.js"></script>
    <script>
      $(document).foundation();

     
    </script>
    <script src="asset/chart/all-min.js"></script><script type="text/javascript">$(function(){    var mwebii=0;    var mwebChartEleId = 'mweb-chart-ele-';    $('pre>code').each(function(){        mwebii++;        var eleiid = mwebChartEleId+mwebii;        if($(this).hasClass('language-sequence')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = Diagram.parse($(this).text());            diagram.drawSVG(eleiid,{theme: 'simple'});        }else if($(this).hasClass('language-flow')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = flowchart.parse($(this).text());            diagram.drawSVG(eleiid);        }    });});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>

  </body>
</html>
