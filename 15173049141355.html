<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  OpenSSH - 
  
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
  <script src="asset/highlightjs/highlight.pack.js"></script>
  <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
  function before_search(){
    var searchVal = 'site: ' + document.getElementById('search_input').value;
    document.getElementById('search_q').value = searchVal;
    return true;
  }
</script>
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>


  <section class="top-bar-section">
  <div class="row">
      <div style="position: relative;width:100%;"><div style="position: absolute; width:100%;">
        <ul id="main-menu" class="left">
        
        <li id=""><a target="self" href="index.html">Home</a></li>
        
        <li id=""><a target="_self" href="archives.html">Archives</a></li>
        
        </ul>

        <ul class="right" id="search-wrap">
          <li>
<form target="_blank" onsubmit="return before_search();" action="http://google.com/search" method="get">
    <input type="hidden" id="search_q" name="q" value="" />
    <input tabindex="1" type="search" id="search_input"  placeholder="Search"/>
</form>
</li>
          </ul>
      </div></div>
  </div>
  </section>

</nav>

        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; </span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
       
       <li><a href="index.html">HOME</a></li>
    <li><a href="archives.html">Archives</a></li>
    <li><a href="about.html">ABOUT</a></li>

    <li><label>Categories</label></li>

        
            <li><a href="C++.html">C++</a></li>
        
            <li><a href="Xcode.html">Xcode</a></li>
        
            <li><a href="Linux.html">Linux</a></li>
        
            <li><a href="Crypt.html">Crypt</a></li>
        
            <li><a href="Computer.html">Computer</a></li>
        
            <li><a href="genome.html">genome</a></li>
         

      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
        
       

 <script type="text/javascript">
  $(function(){
    $('#menu_item_index').addClass('is_active');
  });
</script>
<div class="row">
  <div class="large-8 medium-8 columns">
      <div class="markdown-body article-wrap">
       <div class="article">
          
          <h1>OpenSSH</h1>
     
        <div class="read-more clearfix">
          <span class="date">2018/1/30</span>

          <span>posted in&nbsp;</span> 
          
              <span class="posted-in"><a href='Crypt.html'>Crypt</a></span>
           
         
          <span class="comments">
            

            
          </span>

        </div>
      </div><!-- article -->

      <div class="article-content">
      <ul>
<li>
<a href="#toc_0">OpenSSL</a>
<ul>
<li>
<a href="#toc_1">对称加密</a>
<ul>
<li>
<a href="#toc_2">AES加密</a>
<ul>
<li>
<a href="#toc_3">aes-128-cbc</a>
</li>
<li>
<a href="#toc_4">aes-128-ecb</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


<p>OpenSSH 是SSH协议的实现。</p>

<p>OpenSSL提供两个库libssl 和 libcrypto, OpenSSH 使用libcrypto中的加密算法。</p>

<h2 id="toc_0">OpenSSL</h2>

<p>密码学库</p>

<h3 id="toc_1">对称加密</h3>

<p>openssl参数</p>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td>-S</td>
<td>密码学盐</td>
<td>从-S和-k导出key和iv</td>
</tr>
<tr>
<td>-k</td>
<td>key导出参数(hex mode)</td>
<td>从-S和-k导出key和iv</td>
</tr>
<tr>
<td>-K,-iv</td>
<td>制定key和iv(hex mode)</td>
<td>若指定-K，则一定要有iv</td>
</tr>
<tr>
<td>-iv</td>
<td>指定iv(hex mode)</td>
<td>可单独指定iv</td>
</tr>
<tr>
<td>-P</td>
<td>显示加密所用参数</td>
<td>此时只显示参数，不进行加密操作</td>
</tr>
<tr>
<td>-p</td>
<td>显示加密所用参数</td>
<td>执行加密操作</td>
</tr>
</tbody>
</table>

<p>若不指定密码学盐，则随机生成8Byte盐，并记录在加密文件中Magic word之后。</p>

<pre><code class="language-c">//例如盐为123
//Magic word is &#39;Salted__&#39; = &#39;5361 6c74 6564 5f5f&#39;
//所以第一行16byte是
5361 6c74 6564 5f5f 1230 0000 0000 0000
4e00 3bcc 658a 9d03 2fbd 47c8 3d66 58e1
325f 368a 8fe8 4542 0fdf 978c 0471 ff88
4e0c 6dae b9f4 5825 bc10 e0c8 b059 e785
c0f1 ac26 a669 a281 948d adc3 caab f686
effc 918b 1ddb ed1e b261 4b1a ea9e 5a4c
76af 8e28 6029 fc5e 7fd5 21ad b39d 5526
7fc2 79a2 423b 9d91 47d2 023f 8b3b 63af
f84f 8088 44e4 b873 c22c bb01 81b6 6ba7
ffab 4273 be6d cc6b 6448 948e a248 4710
d7cb 145c 1671 9d3e 2666 4e37 04b9 bbc7
160e f879 528f c406 0d60 3766 3867 e0ec
8eca 19a6 d488 28c0 062f e4bb 5eca 1a81
9c74 37d8 ca3d f698 a7fa 2581 8b9c dec5
d852 d2e5 18a3 9853 5051 ca8b 316b 7007
b72f a1f1 0aa9 2e7f 54ef 61e9 0785 57ca
</code></pre>

<h4 id="toc_2">AES加密</h4>

<p>实现了aes-128-cbc,aes-128-ecb,aes-192-cbc,aes-192-ecb,aes-256-cbc,aes-256-ecb</p>

<h5 id="toc_3">aes-128-cbc</h5>

<pre><code class="language-c">openssl aes-128-cbc -in ecdsa -out ecdsa.aes
</code></pre>

<p>对文件进行加密，需要输入密码，加密后文件变大(227B-256B),打开文件查看，开头是<em>Salted__</em>字符串。</p>

<pre><code class="language-c">openssl aes-128-cbc -d -in ecdsa.aes -out ecdsa.aes.org
</code></pre>

<p>解密时输入密码，则还原出原文件。若密码输入错误会报警。</p>

<p>若篡改加密文件的开头<em>Salted__</em>,则会出错<strong>bad magic number</strong></p>

<p>若篡改密文，则会出<strong>bad decrypt</strong>,但是不能立即显示解密失败，需要先处理一段时间。</p>

<table>
<thead>
<tr>
<th>aes-128-cbc</th>
<th>原文长度</th>
<th>加密后长度</th>
</tr>
</thead>

<tbody>
<tr>
<td></td>
<td>227</td>
<td>256</td>
</tr>
<tr>
<td></td>
<td>239</td>
<td>256</td>
</tr>
<tr>
<td></td>
<td>240</td>
<td>272</td>
</tr>
</tbody>
</table>

<p><strong>同一文件，使用相同密码加密，两次得到的加密文件不同</strong>。</p>

<pre><code class="language-c">openssl aes-128-cbc -in ecdsa -out ecdsa.aes
openssl aes-128-cbc -in ecdsa -out ecdsa.aes2
</code></pre>

<p>例如ecdsa.aes 与 ecdsa.aes2不同</p>

<h5 id="toc_4">aes-128-ecb</h5>

<p>同样有魔法数字 <em>Salted__</em></p>

<p>同一文件，同一密码，两次加密文件不同</p>

<table>
<thead>
<tr>
<th>aes-128-ecb</th>
<th>原文长度</th>
<th>加密后长度</th>
</tr>
</thead>

<tbody>
<tr>
<td></td>
<td>239</td>
<td>256</td>
</tr>
<tr>
<td></td>
<td>240</td>
<td>272</td>
</tr>
</tbody>
</table>


    

      </div>

      <div class="row">
        <div class="large-6 columns">
        <p class="text-left" style="padding:15px 0px;">
      
          <a href="15173049141059.html" 
          title="Previous Post: Linux页缓存">&laquo; Linux页缓存</a>
      
        </p>
        </div>
        <div class="large-6 columns">
      <p class="text-right" style="padding:15px 0px;">
      
          <a  href="15173049141721.html" 
          title="Next Post: 流程">流程 &raquo;</a>
      
      </p>
        </div>
      </div>
      <div class="comments-wrap">
        <div class="share-comments">
          

          

          
        </div>
      </div>
    </div><!-- article-wrap -->
  </div><!-- large 8 -->




 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <h1></h1>
                <div class="site-des"></div>
                <div class="social">











  <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a>
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="C++.html"><strong>C++</strong></a>
        
            <a href="Xcode.html"><strong>Xcode</strong></a>
        
            <a href="Linux.html"><strong>Linux</strong></a>
        
            <a href="Crypt.html"><strong>Crypt</strong></a>
        
            <a href="Computer.html"><strong>Computer</strong></a>
        
            <a href="genome.html"><strong>genome</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="15173054141309.html">Illumina Sequencing</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15173054141798.html">Illumina二代测序原理</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15173054025402.html">DNA基本关系</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15173053129472.html">字符编码</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15173052079033.html">跨平台C／C++系统／编译器检测</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
</div>

        </section>
      </div>
    </div>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>

    <script src="asset/chart/all-min.js"></script><script type="text/javascript">$(function(){    var mwebii=0;    var mwebChartEleId = 'mweb-chart-ele-';    $('pre>code').each(function(){        mwebii++;        var eleiid = mwebChartEleId+mwebii;        if($(this).hasClass('language-sequence')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = Diagram.parse($(this).text());            diagram.drawSVG(eleiid,{theme: 'simple'});        }else if($(this).hasClass('language-flow')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = flowchart.parse($(this).text());            diagram.drawSVG(eleiid);        }    });});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>


  </body>
</html>
